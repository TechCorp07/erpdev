<!-- templates/website/team/manage_team.html -->
{% extends "website_base.html" %}
{% load static %}

{% block title %}Manage Team - BlitzTech Electronics{% endblock %}

{% block extra_css %}
<style>
/* Custom styles for team management */
.team-card {
    transition: all 0.3s ease;
    border: 1px solid #e9ecef;
    border-radius: 12px;
    overflow: hidden;
    background: white;
}
.team-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 8px 25px rgba(0,0,0,0.1);
    border-color: #007bff;
}
.team-avatar {
    width: 120px;
    height: 120px;
    border-radius: 50%;
    object-fit: cover;
    border: 4px solid #fff;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    margin: -60px auto 1rem;
    position: relative;
    z-index: 2;
}
.team-header {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    height: 80px;
    position: relative;
}
.team-info {
    padding: 0 1.5rem 1.5rem;
    text-align: center;
}
.social-links a {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 32px;
    height: 32px;
    border-radius: 50%;
    background: #f8f9fa;
    color: #6c757d;
    text-decoration: none;
    margin: 0 0.25rem;
    transition: all 0.3s ease;
}
.social-links a:hover {
    background: #007bff;
    color: white;
    transform: translateY(-2px);
}
.status-indicator {
    position: absolute;
    top: 1rem;
    right: 1rem;
    z-index: 3;
}
.team-stats {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    border-radius: 12px;
    padding: 2rem;
}
.filter-tabs {
    background: #f8f9fa;
    border-radius: 8px;
    padding: 0.5rem;
    margin-bottom: 2rem;
}
.filter-tab {
    border: none;
    background: none;
    padding: 0.5rem 1rem;
    border-radius: 6px;
    transition: all 0.3s ease;
    color: #6c757d;
    margin-right: 0.5rem;
}
.filter-tab.active {
    background: #007bff;
    color: white;
}
.team-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 2rem;
}
</style>
{% endblock %}

{% block content %}
<div class="container py-4">
  <!-- Header Section -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <div>
      <h2><i class="bi bi-people-fill me-2 text-primary"></i>Manage Team</h2>
      <p class="text-muted mb-0">Showcase your team members and their expertise</p>
    </div>
    <div>
      <a href="{% url 'website:manage_dashboard' %}" class="btn btn-outline-secondary me-2">
        <i class="bi bi-arrow-left"></i> Back to Dashboard
      </a>
      <a href="{% url 'website:add_team_member' %}" class="btn btn-primary">
        <i class="bi bi-plus-lg"></i> New Team Member
      </a>
    </div>
  </div>

  {% if team_members %}
    <!-- Team Statistics -->
    <div class="row mb-4">
      <div class="col-12">
        <div class="team-stats">
          <div class="row text-center">
            <div class="col-md-3">
              <h3 class="mb-1">{{ team_members.count }}</h3>
              <p class="mb-0 opacity-75">Total Team Members</p>
            </div>
            <div class="col-md-3">
              <h3 class="mb-1">{{ team_members|dictsort:"is_active"|length|add:"-"|add:team_members.count }}</h3>
              <p class="mb-0 opacity-75">Active Members</p>
            </div>
            <div class="col-md-3">
              <h3 class="mb-1">{{ team_members|length|add:"-"|dictsort:"email"|length }}</h3>
              <p class="mb-0 opacity-75">With Contact Info</p>
            </div>
            <div class="col-md-3">
              <h3 class="mb-1">{{ team_members|length|add:"-"|dictsort:"linkedin"|length }}</h3>
              <p class="mb-0 opacity-75">With Social Links</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Filter Tabs -->
    <div class="filter-tabs">
      <button class="filter-tab active" data-filter="all">
        All Members <span class="badge bg-primary ms-2">{{ team_members.count }}</span>
      </button>
      <button class="filter-tab" data-filter="active">
        Active <span class="badge bg-success ms-2">{{ team_members|dictsort:"is_active"|length|add:"-"|add:team_members.count }}</span>
      </button>
      <button class="filter-tab" data-filter="inactive">
        Inactive <span class="badge bg-secondary ms-2">{{ team_members|length|add:"-"|dictsort:"is_active"|length }}</span>
      </button>
    </div>

    <!-- Team Members Grid -->
    <div class="team-grid" id="team-grid">
      {% for member in team_members %}
        <div class="team-member-item" 
             data-active="{{ member.is_active|yesno:"true,false" }}">
          <div class="card team-card h-100 position-relative">
            <!-- Status Indicator -->
            <div class="status-indicator">
              {% if member.is_active %}
                <span class="badge bg-success">
                  <i class="bi bi-check-circle-fill me-1"></i>Active
                </span>
              {% else %}
                <span class="badge bg-secondary">
                  <i class="bi bi-pause-circle-fill me-1"></i>Inactive
                </span>
              {% endif %}
            </div>

            <!-- Team Header Background -->
            <div class="team-header"></div>
            
            <!-- Team Member Info -->
            <div class="team-info">
              <!-- Avatar -->
              <div class="d-flex justify-content-center">
                {% if member.image %}
                  <img src="{{ member.image.url }}" 
                       alt="{{ member.name }}" 
                       class="team-avatar">
                {% else %}
                  <div class="team-avatar bg-light d-flex align-items-center justify-content-center">
                    <i class="bi bi-person-fill fs-1 text-muted"></i>
                  </div>
                {% endif %}
              </div>

              <!-- Name and Position -->
              <h5 class="mb-1 fw-bold">{{ member.name }}</h5>
              <p class="text-primary mb-2 fw-semibold">{{ member.position }}</p>

              <!-- Bio -->
              {% if member.bio %}
                <p class="text-muted small mb-3" style="line-height: 1.5;">
                  {{ member.bio|truncatewords:20 }}
                </p>
              {% else %}
                <p class="text-muted small mb-3 fst-italic">
                  No bio provided
                </p>
              {% endif %}

              <!-- Contact Info -->
              {% if member.email %}
                <div class="mb-2">
                  <small class="text-muted">
                    <i class="bi bi-envelope me-1"></i>
                    <a href="mailto:{{ member.email }}" class="text-decoration-none">
                      {{ member.email }}
                    </a>
                  </small>
                </div>
              {% endif %}

              <!-- Social Links -->
              <div class="social-links mb-3">
                {% if member.linkedin %}
                  <a href="{{ member.linkedin }}" target="_blank" title="LinkedIn">
                    <i class="bi bi-linkedin"></i>
                  </a>
                {% endif %}
                {% if member.twitter %}
                  <a href="{{ member.twitter }}" target="_blank" title="Twitter">
                    <i class="bi bi-twitter"></i>
                  </a>
                {% endif %}
                {% if member.github %}
                  <a href="{{ member.github }}" target="_blank" title="GitHub">
                    <i class="bi bi-github"></i>
                  </a>
                {% endif %}
                {% if not member.linkedin and not member.twitter and not member.github %}
                  <small class="text-muted">No social links</small>
                {% endif %}
              </div>

              <!-- Display Order -->
              <div class="mb-3">
                <span class="badge bg-light text-dark">
                  <i class="bi bi-sort-numeric-up me-1"></i>Order: {{ member.order }}
                </span>
              </div>

              <!-- Action Buttons -->
              <div class="d-grid gap-2">
                <div class="btn-group" role="group">
                  <a href="{% url 'website:edit_team_member' member.pk %}" 
                     class="btn btn-outline-primary btn-sm">
                    <i class="bi bi-pencil me-1"></i>Edit
                  </a>
                  <button class="btn btn-outline-info btn-sm" 
                          data-bs-toggle="modal" 
                          data-bs-target="#teamModal{{ member.pk }}">
                    <i class="bi bi-eye me-1"></i>Preview
                  </button>
                  <a href="{% url 'website:delete_team_member' member.pk %}" 
                     class="btn btn-outline-danger btn-sm"
                     onclick="return confirm('Are you sure you want to delete this team member?')">
                    <i class="bi bi-trash me-1"></i>Delete
                  </a>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Team Member Preview Modal -->
        <div class="modal fade" id="teamModal{{ member.pk }}" tabindex="-1">
          <div class="modal-dialog modal-lg">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title">
                  <i class="bi bi-person me-2"></i>{{ member.name }} - Team Profile Preview
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
              </div>
              <div class="modal-body">
                <div class="text-center mb-4">
                  {% if member.image %}
                    <img src="{{ member.image.url }}" 
                         alt="{{ member.name }}" 
                         class="rounded-circle mb-3"
                         style="width: 150px; height: 150px; object-fit: cover;">
                  {% endif %}
                  
                  <h4 class="mb-1">{{ member.name }}</h4>
                  <p class="text-primary fw-semibold mb-3">{{ member.position }}</p>
                  
                  {% if member.bio %}
                    <p class="text-muted">{{ member.bio }}</p>
                  {% endif %}
                  
                  <!-- Contact Information -->
                  <div class="row justify-content-center">
                    <div class="col-md-8">
                      {% if member.email %}
                        <p class="mb-2">
                          <i class="bi bi-envelope me-2"></i>
                          <a href="mailto:{{ member.email }}">{{ member.email }}</a>
                        </p>
                      {% endif %}
                      
                      <!-- Social Links -->
                      <div class="d-flex justify-content-center gap-3 mt-3">
                        {% if member.linkedin %}
                          <a href="{{ member.linkedin }}" target="_blank" class="btn btn-outline-primary btn-sm">
                            <i class="bi bi-linkedin me-1"></i>LinkedIn
                          </a>
                        {% endif %}
                        {% if member.twitter %}
                          <a href="{{ member.twitter }}" target="_blank" class="btn btn-outline-info btn-sm">
                            <i class="bi bi-twitter me-1"></i>Twitter
                          </a>
                        {% endif %}
                        {% if member.github %}
                          <a href="{{ member.github }}" target="_blank" class="btn btn-outline-dark btn-sm">
                            <i class="bi bi-github me-1"></i>GitHub
                          </a>
                        {% endif %}
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <a href="{% url 'website:edit_team_member' member.pk %}" class="btn btn-primary">
                  <i class="bi bi-pencil me-1"></i>Edit Profile
                </a>
              </div>
            </div>
          </div>
        </div>
      {% endfor %}
    </div>

    <!-- No Items Message (for filtered views) -->
    <div id="no-team-message" class="text-center py-5" style="display: none;">
      <i class="bi bi-funnel display-1 text-muted"></i>
      <h4 class="text-muted mt-3">No Team Members Match This Filter</h4>
      <p class="text-muted">Try selecting a different filter or add more team members.</p>
    </div>

  {% else %}
    <!-- Empty State -->
    <div class="text-center py-5">
      <div class="mb-4">
        <i class="bi bi-people-fill display-1 text-muted"></i>
      </div>
      <h4 class="text-muted mb-3">No Team Members Yet</h4>
      <p class="text-muted mb-4">
        Introducing your team builds trust and helps potential clients connect with the people behind your company.
        <br>
        Start by adding key team members who interact with clients or lead important projects.
      </p>
      <a href="{% url 'website:add_team_member' %}" class="btn btn-primary btn-lg">
        <i class="bi bi-plus-lg me-2"></i>Add Your First Team Member
      </a>
      
      <!-- Tips for Team Profiles -->
      <div class="mt-4">
        <h6 class="text-muted">Essential team profile elements:</h6>
        <div class="d-flex justify-content-center flex-wrap gap-2 mt-2">
          <span class="badge bg-light text-dark">Professional headshot</span>
          <span class="badge bg-light text-dark">Clear job title</span>
          <span class="badge bg-light text-dark">Brief expertise summary</span>
          <span class="badge bg-light text-dark">Contact information</span>
          <span class="badge bg-light text-dark">Professional social links</span>
        </div>
      </div>
    </div>
  {% endif %}
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Filter functionality
    const filterTabs = document.querySelectorAll('.filter-tab');
    const teamItems = document.querySelectorAll('.team-member-item');
    const noTeamMessage = document.getElementById('no-team-message');
    
    filterTabs.forEach(tab => {
        tab.addEventListener('click', function() {
            const filter = this.dataset.filter;
            
            // Update active tab
            filterTabs.forEach(t => t.classList.remove('active'));
            this.classList.add('active');
            
            // Filter team members
            let visibleCount = 0;
            teamItems.forEach(item => {
                let shouldShow = false;
                
                switch(filter) {
                    case 'all':
                        shouldShow = true;
                        break;
                    case 'active':
                        shouldShow = item.dataset.active === 'true';
                        break;
                    case 'inactive':
                        shouldShow = item.dataset.active === 'false';
                        break;
                }
                
                if (shouldShow) {
                    item.style.display = 'block';
                    visibleCount++;
                } else {
                    item.style.display = 'none';
                }
            });
            
            // Show/hide no items message
            if (visibleCount === 0 && filter !== 'all') {
                noTeamMessage.style.display = 'block';
            } else {
                noTeamMessage.style.display = 'none';
            }
        });
    });
});
</script>
{% endblock %}
